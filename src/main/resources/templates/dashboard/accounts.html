<div th:fragment="content">
  <div class="max-w-6xl mx-auto bg-white shadow rounded-2xl p-6 space-y-6 animate-fade-in">

    <!-- üè¶ Ti√™u ƒë·ªÅ -->
    <div class="flex justify-between items-center">
      <h2 class="text-2xl font-semibold text-gray-700">V√≠ / T√†i kho·∫£n c·ªßa b·∫°n</h2>
      <span class="text-sm text-gray-500">T·ªïng s·ªë v√≠: <b th:text="${accounts.size()}">0</b></span>
    </div>

    <!-- üü¢ Th√¥ng b√°o -->
    <div th:if="${success}" class="bg-green-100 text-green-700 p-3 rounded-lg" th:text="${success}"></div>
    <div th:if="${error}" class="bg-red-100 text-red-700 p-3 rounded-lg" th:text="${error}"></div>

    <!-- üü¢ Form th√™m t√†i kho·∫£n -->
    <form th:action="@{/dashboard/accounts/add}" method="post"
          class="flex flex-wrap gap-3 items-center border-b pb-4">
      <input type="text" name="name" placeholder="T√™n v√≠ / t√†i kho·∫£n"
             class="flex-1 border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500"
             required>

      <input type="number" name="balance" step="0.01" placeholder="S·ªë d∆∞ ban ƒë·∫ßu"
             class="w-48 border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500"
             required>

      <select name="currency"
              class="border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-indigo-500">
        <option value="VND">VND</option>
        <option value="USD">USD</option>
        <option value="EUR">EUR</option>
      </select>

      <button type="submit"
              class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded transition">
        + Th√™m v√≠
      </button>
    </form>

    <!-- üíº Danh s√°ch v√≠ -->
    <div class="overflow-x-auto mt-4">
      <table class="w-full border-collapse">
        <thead>
        <tr class="bg-gray-100 text-gray-700">
          <th class="text-left py-2 px-3">T√™n v√≠</th>
          <th class="text-right py-2 px-3">S·ªë d∆∞ hi·ªán t·∫°i</th>
          <th class="text-left py-2 px-3">Ti·ªÅn t·ªá</th>
          <th class="text-left py-2 px-3">Ng√†y t·∫°o</th>
          <th class="text-right py-2 px-3">H√†nh ƒë·ªông</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="acc : ${accounts}" class="border-b hover:bg-gray-50 transition">
          <td class="py-2 px-3 font-medium text-gray-800" th:text="${acc.name}"></td>

          <!-- ‚úÖ S·ªë d∆∞: l·∫•y gi√° tr·ªã m·ªõi nh·∫•t t·ª´ DB, hi·ªÉn th·ªã m√†u -->
          <td class="py-2 px-3 text-right font-semibold"
              th:text="${#numbers.formatDecimal(acc.balance, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"
              th:classappend="${acc.balance >= 0} ? 'text-green-600' : 'text-red-600'"></td>

          <td class="py-2 px-3" th:text="${acc.currency}"></td>
          <td class="py-2 px-3 text-gray-500"
              th:text="${#temporals.format(acc.createdAt, 'dd/MM/yyyy')}"></td>

          <!-- ‚öôÔ∏è H√†nh ƒë·ªông -->
          <td class="py-2 px-3 text-right space-x-2">

            <!-- ‚úèÔ∏è C·∫≠p nh·∫≠t -->
            <form th:action="@{'/dashboard/accounts/update/' + ${acc.id}}" method="post"
                  class="inline-flex gap-2 items-center">
              <input type="text" name="name" th:value="${acc.name}"
                     class="border rounded px-2 py-1 w-32">
              <input type="number" step="0.01" name="balance"
                     th:value="${acc.balance}"
                     class="border rounded px-2 py-1 w-28">
              <select name="currency" class="border rounded px-2 py-1">
                <option value="VND" th:selected="${acc.currency == 'VND'}">VND</option>
                <option value="USD" th:selected="${acc.currency == 'USD'}">USD</option>
                <option value="EUR" th:selected="${acc.currency == 'EUR'}">EUR</option>
              </select>
              <button type="submit"
                      class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded">
                S·ª≠a
              </button>
            </form>

            <!-- üóëÔ∏è X√≥a -->
            <a th:href="@{'/dashboard/accounts/delete/' + ${acc.id}}"
               onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a v√≠ n√†y kh√¥ng?');"
               class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded">
              X√≥a
            </a>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- üí∞ T·ªïng k·∫øt -->
    <p class="text-right text-gray-700 mt-3">
      T·ªïng s·ªë d∆∞: <span class="font-semibold text-indigo-600"
                        th:text="${#numbers.formatDecimal(totalBalance, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">0 ‚Ç´</span>
    </p>
  </div>
</div>

<style>
  .animate-fade-in {
    animation: fadeIn 0.4s ease-in-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
